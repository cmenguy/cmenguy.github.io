<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Analyzing 2 months of real crime data from San Francisco and Seattle - Gradient Dissent</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

/*some stuff for output/input prompts*/
div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
@media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
div.prompt:empty{padding-top:0;padding-bottom:0}
div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
div.inner_cell{width:90%;}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
div.output_prompt{color:darkred;}

a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
/* end stuff for output/input prompts*/


.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}
</style>

<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>

<link rel="canonical" href="http://gradientdissent.com/blog/analyzing-2-months-of-real-crime-data-from-san-francisco-and-seattle.html">

        <meta name="author" content="Charles Menguy" />
        <meta name="keywords" content="python,pandas,gis,dataviz,data-science,clustering" />
        <meta name="description" content="The full data analysis described in this blog post can be found in the IPython notebook in the crime-analytics repository. I took part a couple weeks ago in the Coursera course Communicating Data Science Results as part of the Data Science at Scale specialization. It has been a great course ..." />

        <meta property="og:site_name" content="Gradient Dissent" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Analyzing 2 months of real crime data from San Francisco and Seattle"/>
        <meta property="og:url" content="http://gradientdissent.com/blog/analyzing-2-months-of-real-crime-data-from-san-francisco-and-seattle.html"/>
        <meta property="og:description" content="The full data analysis described in this blog post can be found in the IPython notebook in the crime-analytics repository. I took part a couple weeks ago in the Coursera course Communicating Data Science Results as part of the Data Science at Scale specialization. It has been a great course ..."/>
        <meta property="article:published_time" content="2016-02-05" />
            <meta property="article:section" content="misc" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="pandas" />
            <meta property="article:tag" content="gis" />
            <meta property="article:tag" content="dataviz" />
            <meta property="article:tag" content="data-science" />
            <meta property="article:tag" content="clustering" />
            <meta property="article:author" content="Charles Menguy" />

    <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@cmenguy">
        <meta name="twitter:creator" content="@cmenguy">
    <meta name="twitter:domain" content="http://gradientdissent.com">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://gradientdissent.com/theme/css/bootstrap.cosmo.min.css" type="text/css"/>
    <link href="http://gradientdissent.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://gradientdissent.com/theme/css/pygments/native.css" rel="stylesheet">
    <link href="http://gradientdissent.com/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://gradientdissent.com/theme/css/style.css" type="text/css"/>
        <link href="http://gradientdissent.com/static/custom.css" rel="stylesheet">

        <link href="http://gradientdissent.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Gradient Dissent ATOM Feed"/>



        <link href="http://gradientdissent.com/feeds/misc.atom.xml" type="application/atom+xml" rel="alternate"
              title="Gradient Dissent misc ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://gradientdissent.com/" class="navbar-brand"><b>Gradient Dissent</b></a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">

            <ul class="nav navbar-nav">
                        <li><a href="/pages/about.html">About</a></li>
                        <li><a href="/pages/resume.html">Resume</a></li>
                        <li><a href="/index.html">Blog</a></li>
                        <li><a href="feeds/all.atom.xml"><i class="fa fa-lg fa-rss"></i></a></li>
                <li><a href="http://gradientdissent.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
                <!-- social media icons -->
                <ul class="nav navbar-nav navbar-right social">
                        <li><a href="https://www.linkedin.com/in/charlesmenguy"><i class="fa fa-lg fa-linkedin"></i></a></li>
                        <li><a href="https://github.com/cmenguy"><i class="fa fa-lg fa-github"></i></a></li>
                        <li><a href="https://twitter.com/cmenguy"><i class="fa fa-lg fa-twitter"></i></a></li>
                        <li><a href="http://stackoverflow.com/users/1332690/charles-menguy"><i class="fa fa-lg fa-stack-overflow"></i></a></li>
                        <li><a href="http://www.infoq.com/author/Charles-Menguy"><i class="fa fa-lg fa-newspaper-o"></i></a></li>
                        <li><a href="https://www.coursera.org/user/i/e6c7809cb65307e8057090514dd4367e"><i class="fa fa-lg fa-university"></i></a></li>
                        <li><a href="https://www.kaggle.com/cmenguy"><i class="fa fa-lg fa-bar-chart"></i></a></li>
                </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://gradientdissent.com/blog/analyzing-2-months-of-real-crime-data-from-san-francisco-and-seattle.html"
                       rel="bookmark"
                       title="Permalink to Analyzing 2 months of real crime data from San Francisco and Seattle">
                        Analyzing 2 months of real crime data from San Francisco and Seattle
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-02-05T12:35:00-05:00"> Fri 05 February 2016</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://gradientdissent.com/tags/python.html">python</a>
        /
	<a href="http://gradientdissent.com/tags/pandas.html">pandas</a>
        /
	<a href="http://gradientdissent.com/tags/gis.html">gis</a>
        /
	<a href="http://gradientdissent.com/tags/dataviz.html">dataviz</a>
        /
	<a href="http://gradientdissent.com/tags/data-science.html">data-science</a>
        /
	<a href="http://gradientdissent.com/tags/clustering.html">clustering</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <blockquote>
<p>The full data analysis described in this blog post can be found in the IPython notebook in the 
<a href="https://github.com/cmenguy/crime-analytics">crime-analytics</a> repository.</p>
</blockquote>
<p>I took part a couple weeks ago in the Coursera course <a href="https://www.coursera.org/learn/data-results">Communicating Data Science Results</a>
as part of the <a href="https://www.coursera.org/specializations/data-science">Data Science at Scale</a> specialization.</p>
<p>It has been a great course - one of the assignments in particular was great because it was essentially just about taking
a couple datasets, and coming up with our own problem and solution based on the data.</p>
<p>The datasets in questions proposed were real crime data from <a href="https://data.sfgov.org/Public-Safety/SFPD-Incidents-from-1-January-2003/tmnf-yvry">San Francisco</a> 
and <a href="https://data.seattle.gov/Public-Safety/Seattle-Police-Department-Police-Report-Incident/7ais-f98f">Seattle</a>.
These being location-based datasets, I decided to take this opportunity to also get more familiar with the Python
geospatial libraries such as <a href="http://www.gdal.org/">GDAL</a> and how it can be used in tandem with <a href="http://pandas.pydata.org/">pandas</a> <code>DataFrames</code>.</p>
<h1>Temporal Analysis</h1>
<p>Before looking at the geospatial distribution, I wanted to narrow it down to the crimes happening during the night since
cursory analysis revealed that the type of crime has a high correlation with time of day (intuitively too).</p>
<p>Initially I wanted to use <a href="https://github.com/mwaskom/seaborn">seaborn</a>'s heatmap for that, but the results were not 
aesthetically pleasing, so I decided to write my own heatmap system with <code>matplotlib</code>.
For that purpose, here is a function below which creates a grid using simple <code>matplotlib</code> primitives:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preparePlot</span><span class="p">(</span><span class="n">xticks</span><span class="p">,</span> <span class="n">yticks</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">hideLabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">gridColor</span><span class="o">=</span><span class="s1">'#999999'</span><span class="p">,</span>
                <span class="n">gridWidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'white'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">'#999999'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s1">'10'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ticks</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">(),</span> <span class="n">xticks</span><span class="p">),</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">(),</span> <span class="n">yticks</span><span class="p">)]:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'none'</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">'#999999'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hideLabels</span><span class="p">:</span> <span class="n">axis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">gridColor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">gridWidth</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">)</span>
    <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">position</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">position</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">),</span> <span class="p">[</span><span class="s1">'bottom'</span><span class="p">,</span> <span class="s1">'top'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
<p>Then to create the heatmap, we simply need to use <code>matplotlib.pyplot.imshow</code> with <code>nearest</code> interpolation. I also chose
a grey-scale colormap to better represent the intensity of crimes at any given hour:</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_src</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="p">)</span>
</pre></div>
<p>The result shows a heatmap where the intensity is normalized across all hours, where a darker color represents a higher
number of crimes at that hour, and lighter color represents a smaller number of crimes.</p>
<p><img alt="Temporal Distribution of Crimes in SF" class="img-responsive" src="/images/crime-temporal-distribution.png"/></p>
<p>There are some interesting patterns here, and we can see a few crime categories which seem to be particularly frequent
at night. The main offenders seem to be <strong>assault</strong>, <strong>drunkenness</strong>, <strong>larceny/theft</strong>, <strong>prostitution</strong>, <strong>robbery</strong> 
and <strong>vehicle theft</strong>. These are the categories we'll focus on in order to have a meaningful geospatial visualization
to see what San Francisco's crime scene looks like at night.</p>
<h1>Geospatial Analysis</h1>
<p>I had to research a few libraries to use in Python in order to visualize on a map the distribution of crimes.
The complicated part is that I wanted to have access to the neighborhoods information, so I could break crimes down
by neighborhood. Unfortunately, <code>matplotlib</code>'s <a href="http://matplotlib.org/basemap/">Basemap</a> toolkit doesn't provide much
aside from 2D maps. A lot of inspiration for this analysis was drawn from this blog post about <a href="http://sensitivecities.com/so-youd-like-to-make-a-map-using-python-EN.html">blue plaque in London</a>.</p>
<p>To solve it we need a <a href="https://en.wikipedia.org/wiki/Shapefile">Shapefile</a> containing San Francisco's neighborhoods.
Fortunately, there is one available on the <a href="https://data.sfgov.org/Geographic-Locations-and-Boundaries/SFFind-Neighborhoods/ejmn-jyk6">SF open data portal</a>
and it can easily be used via the <code>fiona</code> module.</p>
<div class="highlight"><pre><span></span><span class="n">shp</span> <span class="o">=</span> <span class="n">fiona</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">"/path/to/shapefile.shp"</span><span class="p">)</span>
</pre></div>
<p>From that we can easily compute the map boundaries <code>w</code> and <code>h</code>, and feed those to create a <code>Basemap</code> instance.
We need a couple parameters to create our <code>Basemap</code>:</p>
<ul>
<li>The coordinates where our map should be centered. For San Francisco we use <code>-122</code>, <code>37.7</code></li>
<li>The projection to use - in our case we use the <a href="http://matplotlib.org/basemap/users/tmerc.html">transverse Mercator projection</a>
which should produce a map with less distortion since we are showing a relatively narrow geographic area. For more choice
in projections, see <a href="http://matplotlib.org/basemap/users/mapsetup.html">the complete list</a></li>
<li>The type of ellipsoid - now this one was a bit obscure to me, not being familiar with GIS, but this is actually nothing
more than a coordinate system. It turns out <a href="http://wiki.gis.com/wiki/index.php/WGS84">WGS84</a> is the standard for GPS
so it makes sense to use that in our case.</li>
</ul>
<p>We can put all that together to create a <code>Basemap</code> instance below:</p>
<div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span>
    <span class="n">projection</span><span class="o">=</span><span class="s1">'tmerc'</span><span class="p">,</span>
    <span class="n">lon_0</span><span class="o">=-</span><span class="mf">122.</span><span class="p">,</span>
    <span class="n">lat_0</span><span class="o">=</span><span class="mf">37.7</span><span class="p">,</span>
    <span class="n">ellps</span> <span class="o">=</span> <span class="s1">'WGS84'</span><span class="p">,</span>
    <span class="n">llcrnrlon</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">extra</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span>
    <span class="n">llcrnrlat</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">extra</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span>
    <span class="n">urcrnrlon</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span>
    <span class="n">urcrnrlat</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span>
    <span class="n">lat_ts</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">resolution</span><span class="o">=</span><span class="s1">'i'</span><span class="p">,</span>
    <span class="n">suppress_ticks</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
</pre></div>
<p>Now that we have our <code>Basemap</code>, we can add the content of our Shapefile containing San Francisco's neighborhoods:</p>
<div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">readshapefile</span><span class="p">(</span>
    <span class="s1">'/path/to/shapefile.shp'</span><span class="p">,</span>
    <span class="s1">'SF'</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</pre></div>
<p>At that point, we need to start creating polygons for each neighborhood so that we can convert them into patches that
can be represented on maps. Two particular libraries can help us achieve what we need:</p>
<ul>
<li><a href="http://toblerity.github.com/shapely/">shapely</a> is a library for analyzing and manipulating planar geometric objects in Python. 
In particular, it is useful to create <code>Polygon</code> and <code>Point</code> objects, which for us maps to neighborhoods and crime occurrences.</li>
<li><a href="https://pypi.python.org/pypi/descartes">descartes</a> is the intermediary between shapely's polygons, and matplotlib's maps.
It can be used to create <code>PolygonPatch</code> patches which can be represented on a <code>Basemap</code>.</li>
</ul>
<p>For that purpose we create a <code>DataFrame</code> where for each neighborhood we will have a <code>PolygonPatch</code> based on <code>Polygon</code>
objects extracted from the content of the Shapefile.</p>
<div class="highlight"><pre><span></span><span class="n">df_map</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'poly'</span><span class="p">:</span> <span class="p">[</span><span class="n">Polygon</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">SF</span><span class="p">],</span>
    <span class="s1">'ward_name'</span><span class="p">:</span> <span class="p">[</span><span class="n">ward</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="k">for</span> <span class="n">ward</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">SF_info</span><span class="p">]})</span>
<span class="n">df_map</span><span class="p">[</span><span class="s1">'area_m'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'poly'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
<span class="n">df_map</span><span class="p">[</span><span class="s1">'area_km'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'area_m'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100000</span>
<span class="c1"># Draw neighborhoods with polygons</span>
<span class="n">df_map</span><span class="p">[</span><span class="s1">'patches'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'poly'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PolygonPatch</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">fc</span><span class="o">=</span><span class="s1">'#000000'</span><span class="p">,</span>
    <span class="n">ec</span><span class="o">=</span><span class="s1">'#ffffff'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
<p>Now we're ready to draw the crime occurrences on the map. Since our data contains <code>Latitude</code> and <code>Longitude</code> columns,
we can easily draw them after making sure they're within the polygon formed by San Francisco's neighborhoods.
For example, to draw all occurrences of vehicle theft:</p>
<div class="highlight"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">sf_night_vehicle_theft_points</span><span class="p">],</span>
    <span class="p">[</span><span class="n">geom</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">sf_night_vehicle_theft_points</span><span class="p">],</span>
    <span class="mi">10</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s1">'cyan'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'cyan'</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">'Vehicle Theft'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>
</pre></div>
<p>And of course we need to draw the neighborhoods polygons on the map as well, in order to visualize the distribution
of crimes in the city. This can be done using a <code>matplotlib.collections.PatchCollection</code> which can be created from
the neighborhood patches computed previously.</p>
<div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">PatchCollection</span><span class="p">(</span><span class="n">df_map</span><span class="p">[</span><span class="s1">'patches'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">match_original</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</pre></div>
<p>The final result is a map of San Francisco with all neighborhood boundaries and crimes represented with different
colors for the 6 categories of crimes that happen mostly at night.</p>
<p><img alt="Geospatial Distribution of crimes in SF" class="img-responsive" src="/images/crime-geospatial-distribution.png"/></p>
<p>We can get a general feeling that the center of the city (especially the Tenderloin) as well as the south are pretty
agitated at night, while the west area is mostly quiet at night in terms of crimes. But this just gives us a general
picture, when we would like to clearly see for each neighborhood how criminal it is. Of course this is a little biased
towards highly-populated neighborhoods, but would still give a good enough idea where to be careful at night.</p>
<p>Before we can divide neighborhoods in criminality level, we need to compute the crime density per neighborhood. This
can easily be done by identifying, for each crime occurrence, in which neighborhood it occurred, count those, and deduce
the crime density.</p>
<div class="highlight"><pre><span></span><span class="n">df_map</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'poly'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">prep</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">contains</span><span class="p">,</span> <span class="n">sf_night_crimes_points</span><span class="p">))))</span>
<span class="n">df_map</span><span class="p">[</span><span class="s1">'density_m'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'area_m'</span><span class="p">]</span>
<span class="n">df_map</span><span class="p">[</span><span class="s1">'density_km'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'count'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_map</span><span class="p">[</span><span class="s1">'area_km'</span><span class="p">]</span>
</pre></div>
<p>We can then apply a clustering algorithm to group neighborhoods into N criminality buckets. In our case, since there
are not that many neighborhoods, 5 groups seem good enough. The algorithm we're using here is 
<a href="https://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization">Jenks natural breaks optimization</a>. This is a pretty
common method used in cartography software, and is available as part of the <a href="https://pysal.readthedocs.org/en/latest/">PySAL</a>
library.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysal.esda.mapclassify</span> <span class="kn">import</span> <span class="n">Natural_Breaks</span> <span class="k">as</span> <span class="n">nb</span>

<span class="n">breaks</span> <span class="o">=</span> <span class="n">nb</span><span class="p">(</span>
    <span class="n">df_map</span><span class="p">[</span><span class="n">df_map</span><span class="p">[</span><span class="s1">'density_km'</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">density_km</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">initial</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
<p>Once the algorithm converges, we have multiple bins that we need to join back to our original neighborhood patches to
figure out to which bin each neighborhood belongs.</p>
<div class="highlight"><pre><span></span><span class="n">jb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'jenks_bins'</span><span class="p">:</span> <span class="n">breaks</span><span class="o">.</span><span class="n">yb</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">df_map</span><span class="p">[</span><span class="n">df_map</span><span class="p">[</span><span class="s1">'density_km'</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df_map</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"jenks_bins"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">"ignore"</span><span class="p">)</span>
<span class="n">df_map</span> <span class="o">=</span> <span class="n">df_map</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">jb</span><span class="p">)</span>
</pre></div>
<p>All that is left at that point is to draw again our <code>PatchCollection</code>, with the small trick of using the <code>set_facecolor</code>
method to apply a color corresponding to the cluster. We used the <code>Blues</code> colormap in this case.</p>
<div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'Blues'</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">PatchCollection</span><span class="p">(</span><span class="n">df_map</span><span class="p">[</span><span class="s1">'patches'</span><span class="p">],</span> <span class="n">match_original</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">()</span>
<span class="n">pc</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">df_map</span><span class="p">[</span><span class="s1">'jenks_bins'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
</pre></div>
<p><img alt="Crime density clustering" class="img-responsive" src="/images/crime-density-tiling.png"/></p>
<hr/>
<p>This was a pretty fun analysis, and a good introduction to geospatial analysis in Python with <code>fiona</code>, <code>descartes</code>,
<code>shapely</code>, <code>Basemap</code> and <code>PySAL</code>. We're barely scratching the surface here by looking at only 2 months worth of data - I
might do a follow-up later with more data since we have daily data since January 2003 which is a lot more crime data
to analyze.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'gradientdissent'; // required: replace example with your forum shortname

                    var disqus_identifier = 'analyzing-2-months-of-real-crime-data-from-san-francisco-and-seattle';
                var disqus_url = 'http://gradientdissent.com/blog/analyzing-2-months-of-real-crime-data-from-san-francisco-and-seattle.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme" class="well well-sm">
    <div class="name-cv">
        <div class="name">Charles Menguy</div>
        <div class="cv"><a href="/pdfs/resume.pdf"><i class="fa fa-file-pdf-o"></i> CV</a></div>
    </div>
    <div class="clear"></div>
        <div class="sub-name">big data | data science | cloud computing</div>
        <div class="contact">charles@gradientdissent.com</div>
        <div class="location">New York City, United States</div>
        <br/>
        <ul class="list-group list-inline tagcloud" id="tags">
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/clustering.html">
                        #clustering
                    </a>
                </li>
                <li class="list-group-item tag-1">
                    <a class="tag" href="http://gradientdissent.com/tags/python.html">
                        #python
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/pandas.html">
                        #pandas
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/gis.html">
                        #gis
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/dataviz.html">
                        #dataviz
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/data-science.html">
                        #data-science
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/blog.html">
                        #blog
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a class="tag" href="http://gradientdissent.com/tags/pelican.html">
                        #pelican
                    </a>
                </li>
        </ul>
</div>
<section class="well well-sm">
    <ul class="list-group list-group-flush">

            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
                <ul class="list-group" id="recentposts">
                    <li class="list-group-item">
                        <a href="http://gradientdissent.com/blog/analyzing-2-months-of-real-crime-data-from-san-francisco-and-seattle.html">
                            Analyzing 2 months of real crime data from San Francisco and Seattle
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://gradientdissent.com/blog/yet-another-data-blog-in-pelican.html">
                            Yet Another Data Blog in Pelican
                        </a>
                    </li>
                </ul>
            </li>




    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="https://news.ycombinator.com/" target="_blank">
                Hacker News
            </a>
        </li>
        <li class="list-group-item">
            <a href="https://databricks.com/blog" target="_blank">
                Databricks Blog
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://blog.christianperone.com/" target="_blank">
                PyEvolve
            </a>
        </li>
        <li class="list-group-item">
            <a href="https://jakevdp.github.io/" target="_blank">
                Pythonic Perambulations
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://archive.ics.uci.edu/ml/" target="_blank">
                UCI Machine Learning Repository
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://www.epita.fr/" target="_blank">
                My school
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Charles Menguy
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://gradientdissent.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://gradientdissent.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://gradientdissent.com/theme/js/respond.min.js"></script>

    <script src="http://gradientdissent.com/theme/js/bodypadding.js"></script>
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'gradientdissent'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-45200068-2']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-56ada96e76fa8aac"></script>
</body>
</html>